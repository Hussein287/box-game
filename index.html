<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>لعبة الصناديق</title>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      text-align: center;
      background-color: #111;
      color: white;
      transition: background-color 0.5s ease;
    }
    .start-screen, .game-screen {
      display: none;
    }
    .visible {
      display: block;
    }
    .box-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }
    .box {
      width: 100px;
      height: 100px;
      background-color: black;
      border: 3px solid #FFD700;
      margin: 10px;
      position: relative;
      cursor: pointer;
      background-image: url('https://cdn-icons-png.flaticon.com/512/3064/3064197.png');
      background-size: 60%;
      background-repeat: no-repeat;
      background-position: center;
      transition: background-color 0.3s ease;
    }
    .box.opened {
      background-image: none;
      cursor: default;
    }
    .text-inside {
      position: absolute;
      top: 35%;
      width: 100%;
      font-weight: bold;
      font-size: 20px;
      user-select: none;
    }
    #scoreboard {
      font-size: 24px;
      margin-top: 15px;
      user-select: none;
    }
    #scoreboard span {
      cursor: pointer;
      margin: 0 10px;
      font-weight: bold;
      user-select: none;
    }
    .image-below {
      margin-top: 20px;
    }
    .image-below img {
      max-width: 350px;
      max-height: 250px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    #winner-message {
      font-size: 28px;
      font-weight: bold;
      margin-top: 30px;
      color: yellow;
      text-shadow: 0 0 5px #000;
    }
  </style>
</head>
<body>
  <div class="start-screen visible" id="start-screen">
    <h1>لعبة الصناديق</h1>
    <input type="text" id="red-team" placeholder="اسم الفريق الأحمر" />
    <input type="text" id="green-team" placeholder="اسم الفريق الأخضر" />
    <br /><br />
    <button onclick="startGame()">ابدأ اللعب</button>
  </div>

  <div class="game-screen" id="game-screen">
    <div id="scoreboard">
      + <span id="green-score-btn">+</span>
      <span id="green-name">الأخضر</span> <span id="green-score">0</span> /
      <span id="red-score">0</span> <span id="red-name">الأحمر</span>
      <span id="red-score-btn">+</span> +
    </div>
    <div class="box-container" id="boxes"></div>
    <div class="image-below" id="image-area"></div>
    <div id="winner-message"></div>
  </div>

  <script>
    const boxesCount = 10;
    let redScore = 0,
      greenScore = 0;
    let redName = "الأحمر",
      greenName = "الأخضر";
    let currentTurn = "red"; // يبدأ بالأحمر
    let openedBoxesCount = 0;
    const images = [
      "https://i.ibb.co/TMW5d40/1.jpg",
      "https://i.ibb.co/gZ0V6CL/2.jpg",
      "https://i.ibb.co/3m4JdpZ/3.jpg",
      "https://i.ibb.co/1t4bxx0n/4.jpg",
      "https://i.ibb.co/ycbVCKh8/5.jpg",
      "https://i.ibb.co/nN5DdmG/6.jpg",
      "https://i.ibb.co/Qgs7T4c/7.jpg",
      "https://i.ibb.co/q3c4Jx9/8.jpg",
      "https://i.ibb.co/NntB7Cv/9.jpg",
      "https://i.ibb.co/rKVjngS/10.jpg",
    ];

    let assignedImages = [];

    function startGame() {
      redName = document.getElementById("red-team").value.trim() || "الأحمر";
      greenName = document.getElementById("green-team").value.trim() || "الأخضر";
      document.getElementById("red-name").textContent = redName;
      document.getElementById("green-name").textContent = greenName;
      document.getElementById("start-screen").classList.remove("visible");
      document.getElementById("game-screen").classList.add("visible");
      document.body.style.backgroundColor = currentTurn === "red" ? "#ffcccc" : "#ccffcc";
      renderBoxes();
      updateScores();
    }

    function renderBoxes() {
      const container = document.getElementById("boxes");
      container.innerHTML = "";
      assignedImages = shuffleArray(images).slice(0, boxesCount);
      for (let i = 0; i < boxesCount; i++) {
        const box = document.createElement("div");
        box.classList.add("box");
        box.dataset.index = i;
        box.dataset.opened = "false";
        box.onclick = () => openBox(box);
        container.appendChild(box);
      }
    }

    function openBox(box) {
      if (box.dataset.opened === "true") return;
      box.dataset.opened = "true";
      box.classList.add("opened");

      // إظهار القفل يختفي عند الفتح
      box.style.backgroundImage = "none";

      // تحديد حقيقة أو كذب عشوائياً
      const isTruth = Math.random() < 0.5;
      const textDiv = document.createElement("div");
      textDiv.className = "text-inside";
      textDiv.textContent = isTruth ? "حقيقة" : "كذب";
      textDiv.style.color = isTruth ? "green" : "red";
      box.appendChild(textDiv);

      // عرض الصورة تحت الصندوق
      const imgArea = document.getElementById("image-area");
      imgArea.innerHTML = "";
      const img = document.createElement("img");
      img.src = assignedImages[box.dataset.index];
      imgArea.appendChild(img);

      openedBoxesCount++;

      // تغيير لون الخلفية حسب الدور
      currentTurn = currentTurn === "red" ? "green" : "red";
      document.body.style.backgroundColor = currentTurn === "red" ? "#ffcccc" : "#ccffcc";

      // لو فتح كل الصناديق نعلن الفائز
      if (openedBoxesCount === boxesCount) {
        announceWinner();
      }
    }

    document.getElementById("red-score-btn").onclick = () => {
      redScore++;
      updateScores();
      checkWin();
    };
    document.getElementById("green-score-btn").onclick = () => {
      greenScore++;
      updateScores();
      checkWin();
    };

    function updateScores() {
      document.getElementById("red-score").textContent = redScore;
      document.getElementById("green-score").textContent = greenScore;
    }

    function checkWin() {
      if (redScore >= 6 || greenScore >= 6) {
        announceWinner();
      }
    }

    function announceWinner() {
      let winnerName = "";
      if (redScore > greenScore) winnerName = redName;
      else if (greenScore > redScore) winnerName = greenName;
      else winnerName = "تعادل";

      const winnerMsg = document.getElementById("winner-message");
      winnerMsg.textContent = winnerName === "تعادل" ? "انتهت اللعبة بالتعادل!" : `فاز الفريق: ${winnerName}`;
    }

    // خلط مصفوفة الصور
    function shuffleArray(array) {
      let arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
  </script>
</body>
</html>
